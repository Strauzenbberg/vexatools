<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vexa Mockup Studio | Alpha</title>
    <style>
        /* * =========================================
         * VEXA DESIGN SYSTEM - CORE CSS
         * =========================================
         */
        :root {
            --bg-dark: #09090b;
            --panel-bg: rgba(24, 24, 27, 0.7);
            --accent: #8b5cf6;
            --accent-hover: #7c3aed;
            --text-main: #fafafa;
            --text-muted: #a1a1aa;
            --border: rgba(255, 255, 255, 0.1);
            --glass: blur(16px);
            --radius-sm: 8px;
            --radius-lg: 16px;
            --font-stack: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; outline: none; }

        body {
            font-family: var(--font-stack);
            background-color: var(--bg-dark);
            color: var(--text-main);
            height: 100vh;
            overflow: hidden; /* App-like feel */
            display: flex;
            flex-direction: column;
        }

        /* Layout Principal: Split Screen */
        .app-container {
            display: flex;
            flex: 1;
            height: 100%;
            overflow: hidden;
        }

        /* * 1. SIDEBAR CONTROLS 
         * Painel esquerdo com controles deslizantes e opções
         */
        .sidebar {
            width: 340px;
            background: var(--panel-bg);
            backdrop-filter: var(--glass);
            -webkit-backdrop-filter: var(--glass);
            border-right: 1px solid var(--border);
            padding: 24px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 32px;
            z-index: 10;
        }

        .brand {
            font-size: 1.25rem;
            font-weight: 700;
            letter-spacing: -0.5px;
            color: var(--text-main);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .brand span { color: var(--accent); }

        /* Grupos de Controle */
        .control-group { display: flex; flex-direction: column; gap: 12px; }
        .control-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-muted);
            font-weight: 600;
        }

        /* Inputs Customizados */
        input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            height: 4px;
            background: #27272a;
            border-radius: 2px;
            cursor: pointer;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: var(--accent);
            cursor: pointer;
            box-shadow: 0 0 10px rgba(139, 92, 246, 0.5);
            transition: transform 0.1s;
        }
        input[type="range"]::-webkit-slider-thumb:hover { transform: scale(1.2); }

        /* Botões de Estilo (Radio Visual) */
        .style-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .style-option {
            background: rgba(255,255,255,0.05);
            border: 1px solid transparent;
            padding: 12px;
            border-radius: var(--radius-sm);
            cursor: pointer;
            text-align: center;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        .style-option:hover { background: rgba(255,255,255,0.1); }
        .style-option.active {
            background: rgba(139, 92, 246, 0.15);
            border-color: var(--accent);
            color: var(--accent);
        }

        /* Gradients Grid */
        .gradient-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; }
        .grad-btn {
            width: 100%;
            aspect-ratio: 1;
            border-radius: 50%;
            border: 2px solid transparent;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .grad-btn:hover { transform: scale(1.1); }
        .grad-btn.active { border-color: #fff; transform: scale(1.1); }

        /* Upload Area */
        .drop-zone {
            border: 2px dashed var(--border);
            border-radius: var(--radius-sm);
            padding: 30px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        .drop-zone:hover { border-color: var(--accent); background: rgba(139, 92, 246, 0.05); }
        .drop-zone p { font-size: 0.85rem; color: var(--text-muted); pointer-events: none; }
        .drop-zone strong { color: var(--text-main); display: block; margin-bottom: 4px; pointer-events: none;}

        /* Botão Download */
        .btn-download {
            margin-top: auto;
            background: var(--accent);
            color: #fff;
            border: none;
            padding: 16px;
            border-radius: var(--radius-sm);
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: background 0.2s;
            box-shadow: 0 4px 20px rgba(139, 92, 246, 0.3);
        }
        .btn-download:hover { background: var(--accent-hover); }

        /* Pro Lock Hook */
        .pro-lock {
            position: relative;
            opacity: 0.5;
            cursor: not-allowed;
        }
        .lock-icon {
            position: absolute;
            top: -5px; right: -5px;
            background: #eab308;
            color: #000;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: bold;
        }

        /* * 2. MAIN CANVAS AREA 
         * Onde a mágica visual acontece
         */
        .main-stage {
            flex: 1;
            background: #000;
            background-image: 
                radial-gradient(circle at 50% 50%, #1a1a20 0%, #000 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
            position: relative;
            overflow: hidden;
        }

        /* O Canvas em si (escondido o real, mostrado o preview visual) */
        canvas {
            max-width: 100%;
            max-height: 100%;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            /* O canvas real pode ser grande, CSS escala para caber na tela */
            object-fit: contain; 
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .app-container { flex-direction: column-reverse; }
            .sidebar { width: 100%; height: 45%; border-right: none; border-top: 1px solid var(--border); }
            .main-stage { height: 55%; padding: 20px; }
            .brand { display: none; } /* Economizar espaço no mobile */
        }

        /* Loader */
        .loader { font-size: 0.9rem; color: var(--accent); display: none;}
    </style>
</head>
<body>

<div class="app-container">
    <aside class="sidebar">
        <div class="brand">⚡ Vexa <span>Studio</span></div>

        <div class="control-group">
            <div class="drop-zone" id="dropZone">
                <input type="file" id="fileInput" accept="image/*" style="display: none;">
                <strong>Upload Image</strong>
                <p>Drag & Drop or Paste (Ctrl+V)</p>
            </div>
        </div>

        <div class="control-group">
            <label class="control-label">Frame Style</label>
            <div class="style-grid">
                <div class="style-option active" onclick="setFrame('macos')">macOS</div>
                <div class="style-option" onclick="setFrame('glass')">Glass</div>
            </div>
        </div>

        <div class="control-group">
            <label class="control-label">Background</label>
            <div class="gradient-grid">
                <div class="grad-btn active" style="background: linear-gradient(135deg, #FF9A9E 0%, #FECFEF 100%);" onclick="setBg('linear-gradient(135deg, #FF9A9E 0%, #FECFEF 100%)')"></div>
                <div class="grad-btn" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);" onclick="setBg('linear-gradient(135deg, #667eea 0%, #764ba2 100%)')"></div>
                <div class="grad-btn" style="background: linear-gradient(135deg, #434343 0%, #000000 100%);" onclick="setBg('linear-gradient(135deg, #434343 0%, #000000 100%)')"></div>
                <div class="grad-btn" style="background: linear-gradient(135deg, #ff758c 0%, #ff7eb3 100%);" onclick="setBg('linear-gradient(135deg, #ff758c 0%, #ff7eb3 100%)')"></div>
                <div class="grad-btn" style="background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAHElEQVQYlWNgYGBg+M9AxYBRh4T///8x4TALAwUA5QMJL5T3SPgAAAAASUVORK5CYII='); border: 1px solid #555;" onclick="setBg('transparent')" title="Transparent"></div>
            </div>
            <div class="style-option pro-lock" style="margin-top: 8px; font-size: 0.8rem; display: flex; justify-content: space-between;">
                <span>Custom Upload</span>
                <span class="lock-icon">PRO</span>
            </div>
        </div>

        <div class="control-group">
            <label class="control-label">Padding: <span id="val-padding">60</span>px</label>
            <input type="range" min="0" max="200" value="60" id="in-padding">
        </div>

        <div class="control-group">
            <label class="control-label">Roundness: <span id="val-radius">12</span>px</label>
            <input type="range" min="0" max="40" value="12" id="in-radius">
        </div>

        <div class="control-group">
            <label class="control-label">Shadow: <span id="val-shadow">Large</span></label>
            <input type="range" min="0" max="100" value="50" id="in-shadow">
        </div>

        <button class="btn-download" id="btnDownload">Download PNG (HD)</button>
    </aside>

    <main class="main-stage">
        <canvas id="canvas"></canvas>
    </main>
</div>

<script>
    /**
     * =========================================
     * VEXA ENGINE - VANILLA JS
     * =========================================
     */
    
    // State Management
    const state = {
        image: new Image(),
        isImageLoaded: false,
        frameType: 'macos', // 'macos' | 'glass'
        background: 'linear-gradient(135deg, #FF9A9E 0%, #FECFEF 100%)',
        padding: 60,
        radius: 12,
        shadowIntensity: 50,
        scale: 2 // Retina quality for export
    };

    // Elements
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const fileInput = document.getElementById('fileInput');
    const dropZone = document.getElementById('dropZone');
    
    // Sliders DOM
    const inPadding = document.getElementById('in-padding');
    const inRadius = document.getElementById('in-radius');
    const inShadow = document.getElementById('in-shadow');

    // Values Display DOM
    const valPadding = document.getElementById('val-padding');
    const valRadius = document.getElementById('val-radius');
    const valShadow = document.getElementById('val-shadow');

    // --- Initialization ---
    // Load a default placeholder image so the canvas isn't empty
    state.image.src = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%2318181b'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-family='sans-serif' font-size='24' fill='%23555'%3EArraste sua imagem aqui%3C/text%3E%3C/svg%3E";
    state.image.onload = () => {
        state.isImageLoaded = true;
        render();
    };

    // --- Core Logic: Render Loop ---
    function render() {
        if (!state.isImageLoaded) return;

        const imgW = state.image.width;
        const imgH = state.image.height;
        
        // Calcular Tamanho Total do Canvas
        // Padding é aplicado em todos os lados
        const totalW = imgW + (state.padding * 2);
        
        // Altura do cabeçalho da janela (apenas para macOS)
        const headerHeight = state.frameType === 'macos' ? 40 : 0;
        const totalH = imgH + headerHeight + (state.padding * 2);

        // Ajustar resolução do canvas (HD)
        canvas.width = totalW;
        canvas.height = totalH;

        // Limpar
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // 1. Draw Background
        if (state.background === 'transparent') {
            // Do nothing, keep transparent
        } else {
            // Criar gradiente baseado na string CSS (Simplificado para MVP: parsing básico)
            // Para o MVP, usaremos linear gradient fixo diagonal se for string de gradiente
            // Se formos sofisticar, precisaríamos de um parser regex complexo.
            // Aqui, vamos hardcodar os presets para garantir performance no Canvas.
            const grad = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            
            if(state.background.includes('#FF9A9E')) { grad.addColorStop(0, '#FF9A9E'); grad.addColorStop(1, '#FECFEF'); }
            else if(state.background.includes('#667eea')) { grad.addColorStop(0, '#667eea'); grad.addColorStop(1, '#764ba2'); }
            else if(state.background.includes('#434343')) { grad.addColorStop(0, '#434343'); grad.addColorStop(1, '#000000'); }
            else if(state.background.includes('#ff758c')) { grad.addColorStop(0, '#ff758c'); grad.addColorStop(1, '#ff7eb3'); }
            else { 
                // Fallback cinza
                grad.addColorStop(0, '#333'); grad.addColorStop(1, '#111'); 
            }
            
            ctx.fillStyle = grad;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        // 2. Setup Shadow
        ctx.save();
        const shadowOpacity = state.shadowIntensity / 100; // 0 to 1
        // Quanto maior a sombra, mais blur e offset Y
        ctx.shadowColor = `rgba(0, 0, 0, ${shadowOpacity})`;
        ctx.shadowBlur = state.shadowIntensity * 1.5;
        ctx.shadowOffsetY = state.shadowIntensity * 0.8;
        
        // Coordenadas da Janela (Frame)
        const frameX = state.padding;
        const frameY = state.padding;
        const frameW = imgW;
        const frameH = imgH + headerHeight;

        // 3. Draw Frame Container (The "Window")
        // Rounded Rect Logic
        roundRect(ctx, frameX, frameY, frameW, frameH, state.radius);
        
        // Preenchimento base da janela
        if(state.frameType === 'glass') {
             // Efeito Glassmorphism Simples (White Translucent)
             ctx.fillStyle = "rgba(255, 255, 255, 0.15)";
        } else {
             // macOS Dark Window
             ctx.fillStyle = "#1e1e24";
        }
        ctx.fill();
        
        // Restore para limpar a sombra dos próximos elementos (não queremos sombra no conteudo interno)
        ctx.restore();

        // 4. Draw Header Elements (macOS only)
        if (state.frameType === 'macos') {
            const circleY = frameY + 20;
            const startX = frameX + 24;
            const gap = 20;

            // Red
            ctx.beginPath(); ctx.arc(startX, circleY, 6, 0, Math.PI * 2); 
            ctx.fillStyle = "#FF5F56"; ctx.fill();
            // Yellow
            ctx.beginPath(); ctx.arc(startX + gap, circleY, 6, 0, Math.PI * 2); 
            ctx.fillStyle = "#FFBD2E"; ctx.fill();
            // Green
            ctx.beginPath(); ctx.arc(startX + gap*2, circleY, 6, 0, Math.PI * 2); 
            ctx.fillStyle = "#27C93F"; ctx.fill();
        }

        // 5. Draw the Image (Clipped inside the frame)
        ctx.save();
        
        // Clip area para a imagem respeitar o radius na parte de baixo
        // A imagem começa DEPOIS do header
        const imgY = frameY + headerHeight;
        
        // Criar caminho de clip apenas na área da imagem
        // Se for macos, o topo é reto (conectado ao header), baixo é arredondado
        // Se for glass, tudo arredondado (mas como desenhamos o bg antes, podemos desenhar a img por cima com margem se quisermos, 
        // ou preencher tudo. Para simplificar, desenhamos a imagem retangular dentro ou arredondada igual).
        
        if (state.frameType === 'macos') {
             // Caminho complexo: Topo flat, base round
             ctx.beginPath();
             ctx.moveTo(frameX, imgY);
             ctx.lineTo(frameX + frameW, imgY);
             ctx.lineTo(frameX + frameW, imgY + imgH - state.radius);
             ctx.quadraticCurveTo(frameX + frameW, imgY + imgH, frameX + frameW - state.radius, imgY + imgH);
             ctx.lineTo(frameX + state.radius, imgY + imgH);
             ctx.quadraticCurveTo(frameX, imgY + imgH, frameX, imgY + imgH - state.radius);
             ctx.closePath();
             ctx.clip();
        } else {
             // Glass: Imagem ocupa area total? Ou tem borda?
             // Vamos fazer estilo "Clean": Imagem ocupa o frame todo
             roundRect(ctx, frameX, frameY, frameW, frameH, state.radius);
             ctx.clip();
        }

        ctx.drawImage(state.image, frameX, imgY, imgW, imgH);
        
        // Glass Shine Overlay (Opcional)
        if(state.frameType === 'glass') {
            ctx.beginPath();
            ctx.moveTo(frameX, frameY);
            ctx.lineTo(frameX + frameW, frameY + frameH);
            ctx.lineTo(frameX, frameY + frameH);
            ctx.fillStyle = "rgba(255,255,255,0.05)";
            ctx.fill();
            
            // Border stroke
            ctx.strokeStyle = "rgba(255,255,255,0.2)";
            ctx.lineWidth = 1;
            roundRect(ctx, frameX, frameY, frameW, frameH, state.radius);
            ctx.stroke();
        }

        ctx.restore();
    }

    // Helper: Rounded Rectangle
    function roundRect(ctx, x, y, w, h, r) {
        if (w < 2 * r) r = w / 2;
        if (h < 2 * r) r = h / 2;
        ctx.beginPath();
        ctx.moveTo(x + r, y);
        ctx.arcTo(x + w, y, x + w, y + h, r);
        ctx.arcTo(x + w, y + h, x, y + h, r);
        ctx.arcTo(x, y + h, x, y, r);
        ctx.arcTo(x, y, x + w, y, r);
        ctx.closePath();
    }

    // --- Interaction Handlers ---

    // 1. Frame Selection
    window.setFrame = (type) => {
        state.frameType = type;
        document.querySelectorAll('.style-option').forEach(el => el.classList.remove('active'));
        // Find element by text content logic or simpler query (MVP hack)
        const opts = document.querySelectorAll('.style-option');
        if(type === 'macos') opts[0].classList.add('active');
        else opts[1].classList.add('active');
        render();
    };

    // 2. Background Selection
    window.setBg = (bgValue) => {
        state.background = bgValue;
        document.querySelectorAll('.grad-btn').forEach(el => el.classList.remove('active'));
        event.target.classList.add('active');
        render();
    }

    // 3. Sliders
    inPadding.addEventListener('input', (e) => {
        state.padding = parseInt(e.target.value);
        valPadding.innerText = state.padding;
        render();
    });
    inRadius.addEventListener('input', (e) => {
        state.radius = parseInt(e.target.value);
        valRadius.innerText = state.radius;
        render();
    });
    inShadow.addEventListener('input', (e) => {
        state.shadowIntensity = parseInt(e.target.value);
        valShadow.innerText = (state.shadowIntensity > 70) ? 'Deep' : (state.shadowIntensity > 30) ? 'Medium' : 'Flat';
        render();
    });

    // 4. Image Upload Logic
    function handleFile(file) {
        if (file && file.type.startsWith('image/')) {
            const reader = new FileReader();
            reader.onload = (e) => {
                state.image.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
    }

    // Drag & Drop
    dropZone.addEventListener('click', () => fileInput.click());
    fileInput.addEventListener('change', (e) => handleFile(e.target.files[0]));
    
    dropZone.addEventListener('dragover', (e) => {
        e.preventDefault();
        dropZone.style.borderColor = '#8b5cf6';
        dropZone.style.background = 'rgba(139, 92, 246, 0.1)';
    });
    dropZone.addEventListener('dragleave', (e) => {
        e.preventDefault();
        dropZone.style.borderColor = 'var(--border)';
        dropZone.style.background = 'transparent';
    });
    dropZone.addEventListener('drop', (e) => {
        e.preventDefault();
        dropZone.style.borderColor = 'var(--border)';
        dropZone.style.background = 'transparent';
        if (e.dataTransfer.files.length) {
            handleFile(e.dataTransfer.files[0]);
        }
    });

    // Global Paste (Ctrl+V)
    document.addEventListener('paste', (e) => {
        const items = e.clipboardData.items;
        for (let i = 0; i < items.length; i++) {
            if (items[i].type.indexOf('image') !== -1) {
                const blob = items[i].getAsFile();
                handleFile(blob);
            }
        }
    });

    // 5. Download
    document.getElementById('btnDownload').addEventListener('click', () => {
        const link = document.createElement('a');
        link.download = `vexa-mockup-${Date.now()}.png`;
        link.href = canvas.toDataURL('image/png', 1.0);
        link.click();
    });

</script>
</body>
</html>
